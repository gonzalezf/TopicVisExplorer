<!--START OF MODALS -->
<!-- Modal rename topic (Model 1)-->
<div class="modal fade" id="renameTopic" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Rename Topic</h5>
        <!--<button type="button" class="close" data-dismiss="modal" aria-label="Close">-->
          <!--<span aria-hidden="true">&times;</span>-->
        </button>
      </div>
      <div class="modal-body">
        <!--Edit topic id (<span id="renameTopicId"></span>) -->
        Name: <input type="text" id="renameTopicId" >
        <span hidden="hidden" id="idTopic"></span>
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" id="rename_topic_button" data-dismiss="modal" >Save changes</button>
      </div>
    </div>
  </div>
</div>


<!-- Modal  Rename topic model 2 (sankey)-->
<div class="modal fade" id="renameTopic2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Rename Topic Model</h5>
        <!--<button type="button" class="close" data-dismiss="modal" aria-label="Close">-->
          <!--<span aria-hidden="true">&times;</span>-->
        </button>
      </div>
      <div class="modal-body">
        <!--Edit topic id (<span id="renameTopicId"></span>) -->
        Name: <input type="text" id="renameTopicId2">
        <span  hidden="hidden" id="idTopic2"></span>
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" id="rename_topic_button2" data-dismiss="modal" >Save changes</button>
      </div>
    </div>
  </div>
</div>

<!-- Split modals-->

<div class="modal fade" id="SplitModal_1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog"  role="document" >
    <div class="modal-content" id="modal_dialog_SplitModal_1">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Topic Splitting</h5>
      </div>
      <div class="modal-body">
        You are going to split the current selected topic (<span class="splitting_topic_1"></span>).  
        <button id="add_cart">Add to card</button>
        <ul id="output"></ul>        

      <form action="/action_page.php">
        <label for="quantity">Number of subtopics:</label>
        <input type="number" id="splitting_number_subtopics"  min="2" max="5", value="2"  onchange="myFunction()"> <!--myFunction should adapt the number of columns from the platform-->
      </form>
      <table  class="tableRelevantDocumentsClass_Split table table-hover" >
        <thead>
        <tr>
          <!--
            <th class="text-center" data-field="topic_perc_contrib" scope="col">Contribution</th>
            <th class="text-center" data-field="text" scope="col">Tweet</th>
            <th class="text-center">Uncategorized</th>
            -->
            <!--Create number of columns regarding the number of sub topics-->
            <script>
            for (const x of Array(parseInt(document.getElementById('splitting_number_subtopics').value)).keys()) {
              document.write('<th class="text-center" data-field="other" scope="col">Sub-topic</th>');

              
            }              
            </script>
        </tr>
        </thead>

    </table>    
  
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="cancel_merging" data-dismiss="modal">Cancel</button>
        <button type="button" id="continue_merging" data-dismiss="modal" class="btn btn-primary">Continue</button>
      </div>
    </div>
  </div>
</div>



<!-- Merge modals-->

<div class="modal fade" id="MergeModal_2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Topic Merging</h5>
      </div>
      <div class="modal-body">
        Are you sure you want to merge topic: (<span class="merging_topic_1"></span>) with topic (<span class="merging_topic_2"></span>) ?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary"  id="cancel_merging_2" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary"  id="apply_merging" data-dismiss="modal"  >Apply</button>
      </div>
    </div>
  </div>
</div>



<div class="modal fade" id="MergeModal_1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Topic Merging</h5>
      </div>
      <div class="modal-body">
        You are going to merge the current selected topic (<span class="merging_topic_1"></span>) with another one.  Do you want to continue?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="cancel_merging" data-dismiss="modal">Cancel</button>
        <button type="button" id="continue_merging" DATA-DISMISS="modal" class="btn btn-primary">Continue</button>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="MergeModal_0" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Topic Merging</h5>
      </div>
      <div class="modal-body">
        You need to select a topic first
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">OK</button>
      </div>
    </div>
  </div>
</div>



<div class="modal fade" id="MergeModal_new_design" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Topic Merging</h5>
      </div>
      <div class="modal-body">
        <span hidden="hidden" class="merging_topic_1"></span>
        From the list, select the topic with wich you want to merge the selected topic: <span id="merging_topic_1_name"></span>
       <!--Choose the topicgoing to merge the current selected topic (<span class="merging_topic_1"></span>) with another one.  Do you want to continue?-->
       <form id="myForm">
        <select id="selectTopicMerge">
        </select>
      </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="cancel_merging" data-dismiss="modal">Cancel</button>
        <button type="button" id="apply_topic_merging"  data-dismiss="modal" class="btn btn-primary">Confirm Merge</button>
      </div>
    </div>
  </div>
</div>
<!--END OF MODALS -->


<meta name="viewport" content="width=device-width, initial-scale=1.0">


<!-- ADD JQUERY-->

<script src="static/js/jquery.min.js"></script>  
<!--<script src="https://code.jquery.com/jquery-1.12.4.js"></script>-->
<!--<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>-->

<!-- ADD JS-->

<script src="static/js/popper.min.js"></script>
<script src="static/js/bootstrap.min.js" ></script>
<!--<script src="static/js/mark.min.js" ></script> We are not using it anymore-->
<script src="static/js/d3.v5.min.js"></script>
<script src="static/js/sankey.js"></script>





<!--ADD CSS-->
<link rel="stylesheet" href="static/css/bootstrap-table.min.css">
<link rel="stylesheet" href="static/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="{{ ldavis_css_url }}">


<!--RANGE SLIDER-->

<link href="static/css/nouislider.css" rel="stylesheet">
<script src="static/js/nouislider.js"></script>

<!-- Plotly-->
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>



<div id={{ visid }}></div>

<script type="text/javascript">
var {{ visid_raw }}_data = {{ vis_json }};
var relevantDocumentsDict = {{relevantDocumentsDict|safe}};
var type_vis = {{type_vis}}
var topic_order = {{topic_order}}
var jsonData = {{vis_json}}




//console.log("AFTER MERGE, ESTE ES EL JSON DATA QUE LLEGA", jsonData)

if(type_vis == 1){
  var new_circle_positions = {{new_circle_positions}} 

}
if(type_vis == 2){
  

  var matrix_sankey = {{matrix_sankey}}
  
  var relevantDocumentsDict_2 = {{relevantDocumentsDict_2|safe}}
  var jsonData_2 = {{vis_json_2|safe}}
  var topic_order_2 = {{topic_order_2}}
}


</script>



<div class="container-fluid">
  

  <div class="row" style="height: 100%"> <!--All the visualization must be placed in this row-->

    <div class="col-4 border-right"  id="BarPlotPanel" >  <!--LDAvisContainer-->
    </div>
    

    <div class="col-4 border-right "   id="CentralPanel"> <!-- "-->

    </div>


    <div class="col-4" id="DocumentsPanel">
      <script>
        if(type_vis == 1){
          var html = '<div id="DocumentsPanel_scenario_1"> <table  id="tableRelevantDocumentsClass_Model1" class= "table table-hover header-fixed"> <thead> <tr> <th class="text-center" data-field="topic_perc_contrib" scope="col">%</th> <th class="text-center" data-field="text" scope="col">Document</th> </tr> </thead> </table></div>';
          document.write(html)

        }

      </script>
    </div>
    </div>  
  </div>
</div>

<script>
  function LDAvis_load_lib(url, callback){
    var s = document.createElement('script');
    s.src = url;
    s.async = true;
    s.onreadystatechange = s.onload = callback;
    s.onerror = function(){console.warn("failed to load library " + url);};
    document.getElementsByTagName("head")[0].appendChild(s);
    
  }

  if(typeof(LDAvis) !== "undefined"){
     // already loaded: just create the visualization
     
     !function(LDAvis){
         new LDAvis("#" + {{ visid }}, {{ visid_raw }}_data);

     }(LDAvis);
  }else if(typeof define === "function" && define.amd){
     
     // require.js is available: use it to load d3/LDAvis
     require.config({paths: {d3: "{{ d3_url[:-3] }}"}});
     require(["d3"], function(d3){
        window.d3 = d3;
        LDAvis_load_lib("{{ ldavis_url }}", function(){
          new LDAvis("#" + {{ visid }}, {{ visid_raw }}_data);
        });
      });
  }else{
      // require.js not available: dynamically load d3 & LDAvis
     
      LDAvis_load_lib("{{ d3_url }}", function(){
           LDAvis_load_lib("{{ ldavis_url }}", function(){
                   new LDAvis("#LDAvisContainer", {{ visid_raw }}_data); //"#" + {{ visid }} 
              })
           });
  }
</script>





<script src="static/js/bootstrap-table.min.js"></script>

