<!--START OF MODALS -->

<!-- Modal rename topic (Model 1)-->
<div class="modal fade" id="renameTopic" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Rename Topic</h5>
        <!--<button type="button" class="close" data-dismiss="modal" aria-label="Close">-->
          <!--<span aria-hidden="true">&times;</span>-->
        </button>
      </div>
      <div class="modal-body">
        <!--Edit topic id (<span id="renameTopicId"></span>) -->
        Name: <input type="text" id="renameTopicId" >
        <span hidden="hidden" id="idTopic"></span>
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" id="rename_topic_button" data-dismiss="modal" >Save changes</button>
      </div>
    </div>
  </div>
</div>


<!-- Modal  Rename topic model 2 (sankey)-->
<div class="modal fade" id="renameTopic2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Rename Topic Model</h5>
        <!--<button type="button" class="close" data-dismiss="modal" aria-label="Close">-->
          <!--<span aria-hidden="true">&times;</span>-->
        </button>
      </div>
      <div class="modal-body">
        <!--Edit topic id (<span id="renameTopicId"></span>) -->
        Name: <input type="text" id="renameTopicId2">
        <span  hidden="hidden" id="idTopic2"></span>
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" id="rename_topic_button2" data-dismiss="modal" >Save changes</button>
      </div>
    </div>
  </div>
</div>







<!-- Split modals-->
<!--<div class="modal fade modal_full_screen" id="SplitTopicModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">-->
<div class="modal fade " id="SplitTopicModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">

  <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog_full_screen" role="document" style='height: 80%'>
    <div class="modal-content model-content_full_screen" style='height: 80%'>
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Topic Splitting</h5>
        <!--<button type="button" class="close" data-dismiss="modal" aria-label="Close">-->
          <!--<span aria-hidden="true">&times;</span>-->
        </button>
      </div>
      <!--<div class="modal-body modal-body_full_screen" style='max-height: calc(100% - 120px); overflow-y: scroll'>-->
      <div class="modal-body " style=' overflow-y: scroll'>

        <!--<input type='text' name='somename' data-provide='slider' data-slider-ticks='[1, 2, 3]' data-slider-min='1' data-slider-max='3' data-slider-step='1' data-slider-value='3' >-->
        You are going to split the current selected topic: <b> <span id="topic_to_split_name"></span></b>.  <br><br> 
        To split a topic, you must select the most relevant documents to the new subtopics. For each category, you may choose as many documents as you deem necessary. Documents in neither subtopic will be categorized automatically.
        
        <!--To split a  topic,  you must select the most relevant documents associated to the new subtopics. You may choose as many documents you wish. Also, you can select 
        more documents selecting different pages at the bottom of this window. 
        -->

        <!--<div id="input"></div>      -->
        <div class="row" > <!--All the visualization must be placed in this row-->
        <!--

          <div class="col-4 border-right"  id="KeywordsPanel_TopicSplitting">
          </div>
        -->
          <!--
          <div class="col-4"  id="CentralPanelTopicSplitting" >
            <table id="CentralPanelTopicSplittingRow"  >     
            </table>         
          </div>   
          -->

          <div class="col-12"  id="DocumentsPanel_TopicSplitting" >
            <table id="tableRelevantDocumentsClass_TopicSplitting"  > <!-- class= "overflow-hidden table table-hover header-fixed"-->
              <thead>
              <tr>                          
                <th class="text-center" data-field="topic_perc_contrib" scope="col">%</th> <th class="text-center" data-field="text" scope="col">Document</th>
              </tr>
              </thead>    
            </table>         
          </div>    
        </div>
    
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="button" id="apply_topic_splitting" class="btn btn-primary"data-dismiss="modal" >Split topic</button>

      </div>
    </div>
  </div>
</div>




<!-- Merge modals-->

<div class="modal fade" id="MergeModal_2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Topic Merging</h5>
      </div>
      <div class="modal-body">
        Are you sure you want to merge topic: (<span class="merging_topic_1"></span>) with topic (<span class="merging_topic_2"></span>) ?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary"  id="cancel_merging_2" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary"  id="apply_merging" data-dismiss="modal"  >Apply</button>
      </div>
    </div>
  </div>
</div>



<div class="modal fade" id="MergeModal_1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Topic Merging</h5>
      </div>
      <div class="modal-body">
        You are going to merge the current selected topic (<span class="merging_topic_1"></span>) with another one.  Do you want to continue?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="cancel_merging" data-dismiss="modal">Cancel</button>
        <button type="button" id="continue_merging" DATA-DISMISS="modal" class="btn btn-primary">Continue</button>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="MergeModal_0" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Topic Merging</h5>
      </div>
      <div class="modal-body">
        You need to select a topic first
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">OK</button>
      </div>
    </div>
  </div>
</div>



<div class="modal fade" id="MergeModal_new_design" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Topic Merging</h5>
      </div>
      <div class="modal-body">
        <span hidden="hidden" class="merging_topic_1"></span>
        From the list, select the topic with which you want to merge the selected topic: <b><span id="merging_topic_1_name"></span></b>
        <br>
       <!--Choose the topicgoing to merge the current selected topic (<span class="merging_topic_1"></span>) with another one.  Do you want to continue?-->
       <form id="selectTopicMergeForm">
        <select id="selectTopicMerge">
        </select>
      </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="cancel_merging" data-dismiss="modal">Cancel</button>
        <button type="button" id="apply_topic_merging"  data-dismiss="modal" class="btn btn-primary">Confirm Merge</button>
      </div>
    </div>
  </div>
</div>

<!--Modal to reverse changes (merging and splitting)-->
<div class="modal fade" id="ReverseModel" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Undo changes</h5>
      </div>
      <div class="modal-body">
        This action will reverse the last topic merging/topic splitting operation. Are you sure do you want to continue?
      </div>
      <div class="modal-footer">
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" id="cancel_merging" data-dismiss="modal">Cancel</button>
          <button type="button" id="apply_reverse_topic_model"  data-dismiss="modal" class="btn btn-primary">Continue</button>
        </div>
      </div>
    </div>
  </div>
</div>





<!-- Modal -->
<div class="modal fade" id="loaddssdsdMe" tabindex="-1" role="dialog" aria-labelledby="loadMeLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content">
      <div class="modal-body text-center">
        <div class="loader"></div>
        <div clas="loader-txt">
          <p>Check out this slick bootstrap spinner modal. <br><br><small>We are addicted to Bootstrap... #love</small></p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="loaddssdsdMe" tabindex="-1" role="dialog" aria-labelledby="loadMeLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content">
      <div class="modal-body text-center">
        <div class="loader"></div>
        <div clas="loader-txt">
          <p>Check out this slick bootstrap spinner modal. <br><br><small>We are addicted to Bootstrap... #love</small></p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Split modals-->
<!--<div class="modal fade modal_full_screen" id="SplitTopicModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">-->
  <div class="modal fade " id="loadMe" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">

    <div class="modal-dialog modal-dialog-centered modal-dialog_full_screen" role="document" >
      <div class="modal-content model-content_full_screen" >
        <div class="modal-body">
          <div class="text-center">
            <div class="spinner-border  text-primary" role="status">
              <span class="sr-only">Loading...</span>
            </div>
            <p>We are calculating the best result for you  <br> 
              This operation usually takes around one minute to complete. Please, wait. </p>

          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal " id="saving_results" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">

    <div class="modal-dialog modal-dialog-centered modal-dialog_full_screen" role="document" >
      <div class="modal-content model-content_full_screen" >
        <div class="modal-body">
          <div class="text-center">
            <div class="spinner-border  text-primary" role="status">
              <span class="sr-only">Loading...</span>
            </div>
            <p>We are saving your results. Please, wait. </p>

          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade " id="export_results_user_study_successfully" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">

    <div class="modal-dialog modal-dialog-centered modal-dialog_full_screen" role="document" >
      <div class="modal-content model-content_full_screen" >
        <div class="modal-body">
          <div class="text-center">
            <p>Thank you! Your results have been saved  </p>

          </div>
        </div>
        <div class="modal-footer">
          <div class="modal-footer">
            <button type="button" id="apply_reverse_topic_model"  data-dismiss="modal" class="btn btn-primary">Ok</button>
          </div>
        </div>

      </div>
    </div>
  </div>

  
  <div class="modal fade " id="error_splitting" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">

    <div class="modal-dialog modal-dialog-centered modal-dialog_full_screen" role="document" >
      <div class="modal-content model-content_full_screen" >
        <div class="modal-body">
          <div class="text-center">
            <p><b>ERROR: </b>You must provide documents for both new subtopics  </p>

          </div>
        </div>
        <div class="modal-footer">
          <div class="modal-footer">
            <button type="button" id="apply_reverse_topic_model"  data-dismiss="modal" class="btn btn-primary">Ok</button>
          </div>
        </div>

      </div>
    </div>
  </div>


  



<!--END OF MODALS -->


<meta name="viewport" content="width=device-width, initial-scale=1.0">



<!-- ADD JQUERY-->
<script src="static/js/jquery.min.js"></script>  


<!-- ADD JS-->
<script src="static/js/popper.min.js"></script>
<script src="static/js/bootstrap.min.js" ></script>
<script src="static/js/d3.v5.min.js"></script>
<script src="static/js/sankey.js"></script>


<!--Fontawesome-->
<link href="/static/fontawesome/css/fontawesome.css" rel="stylesheet">
<link href="/static/fontawesome/css/brands.css" rel="stylesheet">
<link href="/static/fontawesome/css/solid.css" rel="stylesheet">

<!--ADD CSS-->
<link rel="stylesheet" href="static/css/bootstrap-table.min.css">
<link rel="stylesheet" href="static/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="{{ ldavis_css_url }}">


<!--RANGE SLIDER-->
<link href="static/css/nouislider.css" rel="stylesheet">
<script src="static/js/nouislider.js"></script>



<!--for deep copy in JS-->
<script src="/static/js/lodash.js"></script>  



<script src="/static/jquery-checkradios-master/js/jquery.checkradios.min.js"></script>
<link rel="stylesheet" href="/static/jquery-checkradios-master/css/jquery.checkradios.min.css"/>

<!-- Intro .js tour mode -->

<script src="/static/intro-js/intro.min.js"></script>
<link rel="stylesheet" href="/static/intro-js/introjs.min.css"/>



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JST99DG8LH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-JST99DG8LH');
</script>


<!-- Hotjar Tracking Code for topicvisexplorer.tk -->
<script>
  (function(h,o,t,j,a,r){
      h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
      h._hjSettings={hjid:2343426,hjsv:6};
      a=o.getElementsByTagName('head')[0];
      r=o.createElement('script');r.async=1;
      r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
      a.appendChild(r);
  })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>


<div id={{ visid }}></div>




<script type="text/javascript">

var {{ visid_raw }}_data = {{ vis_json }};
var type_vis = {{type_vis}};
var topic_order = {{topic_order}};
var jsonData = {{vis_json}};


if(type_vis == 1){
  var new_circle_positions = {{new_circle_positions}} 
}


if(type_vis == 2){  
  var matrix_sankey = {{matrix_sankey}};  
  var jsonData_2 = {{vis_json_2|safe}};
  var topic_order_2 = {{topic_order_2}};
  
}


</script>


<div class="container-fluid">
  <div class="row" style="height: 100%"> <!--All the visualization must be placed in this row-->
    <div class="col-4 border-right"  id="BarPlotPanel"   id="CentralPanel">  <!--LDAvisContainer-->
    </div>
    <div class="col-4 border-right "  id="CentralPanel"> <!-- "-->
    </div>
    <div class="col-4" id="DocumentsPanel"  >
      <script>
        if(type_vis === 1){
          
          var html = '<div id="DocumentsPanel_first_scenario"> <table  id="tableRelevantDocumentsClass_Model1" </table></div>';
          
          document.write(html)

        }
        if(type_vis === 2){
             var html = '';
        }

        document.write(html) // ojo, esta linea no deberia estar, x eso q se escribe dos veces el DocumentsPanel_first_scenario, pero si lo saco ahora, comienzan a fallar cosas en el scenario 1

      </script>
    </div>
    </div>  
  </div>
</div>

<script>
  function LDAvis_load_lib(url, callback){
    var s = document.createElement('script');
    s.src = url;
    s.async = true;
    s.onreadystatechange = s.onload = callback;
    s.onerror = function(){console.warn("failed to load library " + url);};
    document.getElementsByTagName("head")[0].appendChild(s);
    
  }

  if(typeof(LDAvis) !== "undefined"){
     // already loaded: just create the visualization
     
     !function(LDAvis){
         new LDAvis("#" + {{ visid }}, {{ visid_raw }}_data);

     }(LDAvis);
  }else if(typeof define === "function" && define.amd){
     
     // require.js is available: use it to load d3/LDAvis
     require.config({paths: {d3: "{{ d3_url[:-3] }}"}});
     require(["d3"], function(d3){
        window.d3 = d3;
        LDAvis_load_lib("{{ ldavis_url }}", function(){
          new LDAvis("#" + {{ visid }}, {{ visid_raw }}_data);
        });
      });
  }else{
      // require.js not available: dynamically load d3 & LDAvis
     
      LDAvis_load_lib("{{ d3_url }}", function(){
           LDAvis_load_lib("{{ ldavis_url }}", function(){
                   new LDAvis("#LDAvisContainer", {{ visid_raw }}_data); //"#" + {{ visid }} 
              })
           });
  }
</script>

<script src="static/js/bootstrap-table.long.js"></script>

<script>

function introductionToTopicVisExplorer(){
    

}



</script>

